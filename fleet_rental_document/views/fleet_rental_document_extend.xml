<?xml version="1.0" encoding="UTF-8"?>
<openerp>
    <data>
      <!--RENT EXTEND-->
      <record id='view_fleet_rental_document_extend_tree' model='ir.ui.view'>
        <field name="name">fleet.rental.document.extend.tree</field>
        <field name="model">fleet_rental.document_extend</field>
        <field name="arch" type="xml">
          <tree string="Vehicle Rent Extend" decoration-muted="state=='cancel'">
            <field name="state" invisible="1"/>
            <field name="name"/>
            <field name="partner_id"/>
            <field name="vehicle_id"/>
            <field name="exit_datetime"/>
            <field name="return_date"/>
            <field name="total_rental_period"/>
          </tree>
        </field>
      </record>

      <record id='view_fleet_rental_document_extend_tree_mod' model='ir.ui.view'>
        <field name="name">fleet.rental.document.extend.tree.mod</field>
        <field name="model">fleet_rental.document_extend</field>
        <field name="arch" type="xml">
          <tree string="Vehicle Rent Extend" decoration-muted="state=='cancel'" create="false" delete="false">
            <field name="state" invisible="1"/>
            <field name="name"/>
            <field name="partner_id"/>
            <field name="vehicle_id"/>
            <field name="exit_datetime"/>
            <field name="return_date"/>
            <field name="total_rental_period"/>
          </tree>
        </field>
      </record>

      <record id='fleet_rental_document_extend_form' model='ir.ui.view'>
        <field name="name">fleet.rental.document.extend.form</field>
        <field name="model">fleet_rental.document_extend</field>
        <field name="mode">primary</field>
        <field eval="7" name="priority"/>
        <field name="inherit_id" ref="fleet_rental_document_rent_form"/>
        <field name="arch" type="xml">
          <xpath expr="//field[@name='state']" position="replace">
            <field name="state" widget="statusbar" statusbar_visible="draft,confirmed"/>
          </xpath>
          <xpath expr="//button[@name='action_book']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
          <xpath expr="//button[@name='action_extend']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
          <xpath expr="//button[@name='action_create_return']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
          <xpath expr="//button[@name='action_confirm']" position="replace">
            <button name="action_confirm" string="Confirm Rental" type="object"
                    attrs="{'invisible': ['|', ('state', '=', 'confirmed'), ('new_deposit', '&lt;=', 0)]}"/>
          </xpath>
          <xpath expr="//button[@name='%(action_view_make_invoice_wizard)d']" position="replace">
            <button name="%(action_view_make_invoice_wizard)d" string="Create Invoice"
                    type="action" class="btn-primary" />
          </xpath>
          <xpath expr="//button[@name='print_rent']" position="replace">
              <button name="print_extend" string="Print" type="object"
                      attrs="{'invisible': [('state', 'in', ['draft'])]}"/>
          </xpath>
          <xpath expr="//notebook/page[1]" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
          <xpath expr="//field[@name='check_line_ids']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
          <xpath expr="//field[@name='part_line_ids']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
          <xpath expr="//button[@id='extends_button']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
          <xpath expr="//field[@name='partner_id']" position="attributes">
            <attribute name="readonly">1</attribute>
          </xpath>
          <xpath expr="//field[@name='vehicle_id']" position="attributes">
            <attribute name="readonly">1</attribute>
          </xpath>
          <xpath expr="//field[@name='daily_rental_price']" position="attributes">
            <attribute name="readonly">1</attribute>
          </xpath>
          <xpath expr="//field[@name='rate_per_extra_km']" position="attributes">
            <attribute name="readonly">1</attribute>
          </xpath>
          <xpath expr="//field[@name='odometer_before']" position="attributes">
            <attribute name="readonly">1</attribute>
          </xpath>
          <xpath expr="//field[@name='allowed_kilometer_per_day']" position="attributes">
            <attribute name="readonly">1</attribute>
          </xpath>
          <xpath expr="//field[@name='exit_datetime']" position="attributes">
            <attribute name="readonly">1</attribute>
          </xpath>
          <xpath expr="//field[@name='return_date']" position="attributes">
            <attribute name="readonly">1</attribute>
          </xpath>
          <xpath expr="//field[@name='extend_return_date']" position="attributes">
            <attribute name="invisible">1</attribute>
          </xpath>
          <xpath expr="//field[@name='return_date']" position="after">
            <field name="new_return_date"/>
          </xpath>
          <xpath expr="//field[@name='total_rent_price']" position="after">
            <field name="previous_deposit"/>
            <field name="new_deposit"/>
            <field name="document_rent_id" invisible="1"/>
          </xpath>
        </field>
      </record>

      <!--MENU AND ACTIONS-->
      <record id='fleet_rental_document_extend_draft_act' model='ir.actions.act_window'>
        <field name="name">Draft</field>
        <field name="res_model">fleet_rental.document_extend</field>
        <field name="view_type">form</field>
        <field name="view_id" ref="view_fleet_rental_document_extend_tree_mod"/>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('state','=','draft')]</field>
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to create a new rental extend document.
          </p>
        </field>
      </record>

      <menuitem action="fleet_rental_document_extend_draft_act" parent="fleet_rental_document.fleet_rental_sale_extends" id="rent__draft_extend_menu" sequence="1"/>

      <record id='fleet_rental_document_extend_booked_act' model='ir.actions.act_window'>
        <field name="name">Booked</field>
        <field name="res_model">fleet_rental.document_extend</field>
        <field name="view_type">form</field>
        <field name="view_id" ref="view_fleet_rental_document_extend_tree_mod"/>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('state','=','booked')]</field>
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to create a new rental extend document.
          </p>
        </field>
      </record>

      <menuitem action="fleet_rental_document_extend_booked_act" parent="fleet_rental_document.fleet_rental_sale_extends" id="rent_booked_extend_menu" sequence="2"/>

      <record id='fleet_rental_document_extend_confirmed_act' model='ir.actions.act_window'>
        <field name="name">Confirmed</field>
        <field name="res_model">fleet_rental.document_extend</field>
        <field name="view_type">form</field>
        <field name="view_id" ref="view_fleet_rental_document_extend_tree_mod"/>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('state','=','confirmed')]</field>
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to create a new rental extend document.
          </p>
        </field>
      </record>

      <menuitem action="fleet_rental_document_extend_confirmed_act" parent="fleet_rental_document.fleet_rental_sale_extends" id="rent_confirmed_extend_menu" sequence="3"/>

      <record id='fleet_rental_document_extend_cancel_act' model='ir.actions.act_window'>
        <field name="name">Canceled</field>
        <field name="res_model">fleet_rental.document_extend</field>
        <field name="view_type">form</field>
        <field name="view_id" ref="view_fleet_rental_document_extend_tree_mod"/>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('state','=','cancel')]</field>
        <field name="help" type="html">
          <p class="oe_view_nocontent_create">
            Click to create a new rental extend document.
          </p>
        </field>
      </record>

      <menuitem action="fleet_rental_document_extend_cancel_act" parent="fleet_rental_document.fleet_rental_sale_extends" id="rent_cancel_extend_menu" sequence="4"/>

    </data>
</openerp>
